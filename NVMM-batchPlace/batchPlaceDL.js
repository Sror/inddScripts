#target "InDesign-8.0"var panelFolder  = Folder.selectDialog("Pick Panel Folder");var scriptFolder = Folder.selectDialog("Pick Scripts Folder");if(panelFolder === null || scriptFolder === null) {    alert("No folder selected", "Nope");    } else {    var panelFiles = panelFolder.getFiles("*.indd");    var scriptFiles = scriptFolder.getFiles("*.txt");        app.clearOverridesWhenApplyingStyle = true;    app.textImportPreferences.characterSet = TextImportCharacterSet.UTF8;    app.textImportPreferences.stripReturnsBetweenLines = true;    for(var j = 0; j < panelFiles.length; j ++) {        var doc = app.open(panelFiles[j], false);            var panel = {            exhibit : doc.name.split("_")[0],            topic   : doc.name.split("_")[1],            panel   : doc.name.split("_")[2]        };                var panelNum = panel.panel.slice(2, 4);        var textBoxes = doc.layers.item("TEXT").textFrames;                for(var i = 0; i < textBoxes.length; i++) {                var objectStyle = textBoxes[i].appliedObjectStyle;            var scriptGroup = textBoxes[i].label.slice(0, 4);            var scriptNum = textBoxes[i].label.slice(-1)[0];            var bodyParagraphStyle = doc.paragraphStyles.item("DL Body");            var dateParagraphStyle = doc.paragraphStyles.item("DL Date");            var baseScriptFileName = panel.exhibit + "_" + panel.topic + "_DL" + panelNum + "-" + scriptNum;            if(scriptGroup === "main") {                                var scriptFileName = baseScriptFileName + "T.txt";                placeText(scriptFileName);                        } else if(scriptGroup === "date") {                var scriptFileName = baseScriptFileName + "D.txt";                placeText(scriptFileName);            }                    }            doc.save();        doc.close();            }    function placeText(fileName){        textBoxes[i].contents = "";        textBoxes[i].place(File(scriptFolder + "/" + fileName));        textBoxes[i].applyObjectStyle(objectStyle, true);        textBoxes[i].parentStory.appliedCharacterStyle = doc.characterStyles.item("[None]");        textBoxes[i].parentStory.clearOverrides();    }}